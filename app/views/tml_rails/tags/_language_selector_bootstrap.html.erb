<%
   opts[:element] ||= 'div'
   opts[:class] ||= 'dropdown'
%>

<style>
  .trex-dropdown {
    text-align:<%= tml_current_language.align("left") %>;
  }
  .trex-dropdown .trex-dropdown-menu {
    min-width:200px;
  }
  .trex-native-name {
    padding: 0px 5px;
    color: #ccc;
    font-size: 10px;
  }
  .trex-dropdown .trex-dropdown-footer {
    font-size:10px;
    color:#ccc;
    text-align: center; 
    background: #f5f5f5; 
    padding:5px; 
    margin-top: -10px; 
    margin-bottom: -5px; 
    border-bottom-left-radius: 5px; 
    border-bottom-right-radius: 5px;
  }
</style>


<% if opts[:element] %>
  <<%= opts[:element] %> class="trex-language-selector trex-dropdown <%= opts[:class] %>" style="<%= opts[:style] %>">
<% end %>

  <a href="#" role="button" class="<%= opts[:class] || 'dropdown' %>-toggle" data-toggle="dropdown" dir="<%= tml_current_language.dir %>">
    <%= tml_language_name_tag(tml_current_language, opts) %>
  </a>

  <ul class="dropdown-menu trex-dropdown-menu">

    <% tml_application.languages.each do |lang| %>

      <li dir="<%= tml_current_language.dir %>">
        <% if Tml.config.locale[:subdomain] %>
          <%=link_to(tml_subdomain_locale_url(lang.locale)) do %>
            <%= tml_language_name_tag(lang, opts) %>
          <% end %>
        <% else %>
          <%=link_to({:locale => lang.locale}) do %>
            <%= tml_language_name_tag(lang, opts) %>
          <% end %>
        <% end %>
      </li>

    <% end %>

    <% if opts[:toggle] %>
      <li role='presentation' class='divider'></li>
      <li role='presentation'>
        <a href='javascript:void(0);' onclick='Tml.Utils.toggleInlineTranslations()'>
          <%= tr(opts[:toggle_label] || 'Help Us Translate') %>
        </a>
      </li>
    <% end %>

    <li role='presentation' class='divider'></li>

    <div class="trex-dropdown-footer">
      <a href="http://translationexchange.com" style="color: #888;">
        <%= tr("Powered By {brand}", brand: "Translation Exchange") %>
      </a>
    </div>
  </ul>

<% if opts[:element] %>
  </<%= opts[:element] %>>
<% end %>

